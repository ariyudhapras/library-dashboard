generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int        @id @default(autoincrement())
  name         String
  email        String     @unique
  password     String
  role         String     @default("user")
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  address      String?
  birthDate    DateTime?
  memberId     String     @unique
  phone        String?
  profileImage String?
  status       String     @default("active")
  bookLoans    BookLoan[]
}

model Book {
  id         Int        @id @default(autoincrement())
  title      String
  author     String
  publisher  String?
  year       Int?
  isbn       String?
  stock      Int        @default(1)
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  coverImage String?
  bookLoans  BookLoan[]
}

model BookLoan {
  id               Int        @id @default(autoincrement())
  userId           Int
  bookId           Int
  borrowDate       DateTime
  returnDate       DateTime
  actualReturnDate DateTime?
  status           LoanStatus @default(PENDING)
  notes            String?
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
  book             Book       @relation(fields: [bookId], references: [id])
  user             User       @relation(fields: [userId], references: [id])
}

enum LoanStatus {
  PENDING
  APPROVED
  REJECTED
  RETURNED
  LATE
}
